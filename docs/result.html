<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=1366" />
  <title>งบกรุงเทพมหานคร โดย tupleblog team</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Mitr" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection" />
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
</head>

<body>
  <nav class="white" role="navigation">
    <div class="nav-wrapper container">
      <a id="logo-container" href="#" class="brand-logo black-text">งบกรุงเทพมหานคร</a>
      <ul class="right hide-on-med-and-down">
        <li></li>
      </ul>

      <ul id="nav-mobile" class="sidenav">
        <li></li>
      </ul>
      <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a>
    </div>
  </nav>


  <div class="container" id="app">

    <div>
      <h3 class="center">สรุปแบบสอบถาม</h3>


      <div class="row">

        <div class="col s12 m4"></div>
        <div class="col s12 m4">
          <div class="card">
            <div class="card-content black-text">
              <span class="card-title summary_title">จำนวนแบบสอบถามทั้งหมด</span>
              <div class="divider"></div>
              <p id="survey_amount" class="center card_amount">{{survey_amount}}</p>
            </div>
          </div>
        </div>
        <div class="col s12 m4"></div>




      </div>
    </div>

    <div>
      <h3 class="center">แยกตามเขตที่ผู้ทำแบบสอบถามอยู่อาศัย</h3>
      <p class="center">(เฉพาะ 3 อันดับแรก)</p>
    </div>

    <div id="district-container" class="row district-item">


      <div id="district-loading" v-if="isLoading">
        <div class="preloader-wrapper big active">
          <div class="spinner-layer spinner-blue-only">
            <div class="circle-clipper left">
              <div class="circle"></div>
            </div>
            <div class="gap-patch">
              <div class="circle"></div>
            </div>
            <div class="circle-clipper right">
              <div class="circle"></div>
            </div>
          </div>
        </div>
      </div>



      <div class="col s12 m4" v-for="item in data_district">
        <div class="card-panel">
          <p class="card-title grey-text text-darken-4 center">{{item.district}}</p>
          <div class="row valign-wrapper">

            <div class="col s3">

              <div class="icon-item">
                <i class="material-icons">add</i>
              </div>

            </div>
            <div class="col s9">

              <div class="topic-item" v-for="ti in item.to_increase.slice(0, 3)">{{ ti.budget_type }} ({{ti.amount}})
              </div>

            </div>

          </div>

          <div class="divider"></div>

          <div class="row valign-wrapper decrease-container">

            <div class="col s3">

              <div class="icon-item">
                <i class="material-icons">remove</i>
              </div>

            </div>
            <div class="col s9">

              <div class="topic-item" v-for="ti in item.to_decrease.slice(0, 3)">{{ ti.budget_type }} ({{ti.amount}})
              </div>

            </div>

          </div>
        </div>
      </div>




    </div>

  </div>


  <footer class="page-footer grey lighten-1">
    <div class="footer-copyright">
      <div class="container">
        Made by <a class="grey-text text-lighten-3" href="https://tupleblog.github.io/" target="_BLANK">tupleblog
          team</a>
      </div>
    </div>
  </footer>


  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>
  <script src="js/init.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/vue"></script>

  <script>
    var URL = "https://asia-southeast2-thai-gov-spending.cloudfunctions.net/survey";
    //URL = "http://127.0.0.1:5003/"

    $(document).ready(initChart);


    var appDistrict = new Vue({
      el: '#app',
      data: {
        isLoading: true,
        data_district: [],
        survey_amount: "-",
      }
    });

    function initChart() {

      console.log("initChart");

      $.ajax({
        url: URL,
        dataType: "JSON",
        error: function (err) {
          console.log(err)
        },
        success: function (data) {

          console.log(data)

          if (!data.status) {
            // TODO:
            return false;
          }

          console.log(appDistrict.data_district);

          appDistrict.data_district = data.data_district;
          appDistrict.isLoading = false;

          appDistrict.survey_amount = data.survey_amount

          console.log(appDistrict.data_district)












        }
      });

    }
  </script>

</body>

</html>